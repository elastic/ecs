{%- import 'macros.j2' as macros -%}
---
mapped_pages:
  - https://www.elastic.co/guide/en/ecs/current/ecs-{{ fieldset['name'] }}.html
applies_to:
  stack: all
  serverless: all
---
% This file is automatically generated. Don't edit it manually!

{# Title & Description -#}
# {{ fieldset['title'] }} fields [ecs-{{ fieldset['name'] }}]

{{ fieldset['description'] | replace("\n", "\n\n") }}

{# Fieldset label beta header -#}
{% if fieldset['beta'] -%}

::::{warning}
{{ fieldset['beta'] }}
::::

{% endif -%}

{# Field Details Table Header -#}

## {{ fieldset['title'] }} field details [_{{ fieldset['title'] | lower | replace(" ", "_") }}_field_details]

| Field | Description | Level |
| --- | --- | --- |
{# Iterate through each field in the set -#}
{% for field in sorted_fields -%}
{% if 'original_fieldset' not in field -%}
{% set row -%}
| $$$field-{{ field['dashed_name'] }}$$$ [{{ field['flat_name'] }}](#field-{{ field['dashed_name'] }}) |
{% if field['beta'] -%}
{# referencing non-existant field below keeps leading space -#}
{{ field['foo'] }} _{{ field['beta'] }}_ {{ field['description']|replace("\n", "<br><br>") }}
{%- else -%}
{{ field['foo'] }} {{ field['description']|replace("\n", "<br><br>") }}
{%- endif %}
{% if field['expected_values'] %}
<br><br>Expected values for this field:<br>
{% for val in field['expected_values'] %}
<br>* `{{ val }}`
{%- endfor %}
{%- endif %}
<br><br>type: {{ field['type'] }}
{% if 'multi_fields' in field -%}
<br><br>Multi-fields:<br>
{% for mf in field['multi_fields'] -%}
<br>* {{ mf['flat_name'] }} (type: {{ mf['type'] }})
{% endfor %}
{% endif %}
{% if 'array' in field['normalize'] -%}
<br><br>Note: This field should contain an array of values.
{% endif %}
{% if 'allowed_values' in field %}
<br><br>**Important:** The field value must be one of the following:
<br><br>{{ field['allowed_value_names']|join(', ') }}
<br><br>To learn more about when to use which value, visit the page [allowed values for {{ field['flat_name'] }}](/reference/ecs-allowed-values-{{ field['dashed_name'] }}.md)<br>
{% elif 'example' in field -%}
<br><br>example: `{{ field['example'] }}`
{%- endif %}
{% if field['otel'] -%}
{%- for otel in field['otel'] %}
<br><br>{{ macros.otel_badge }} {{ macros.otel_relation_badge(otel) }} {{ macros.otel_link(field, otel) }}
{%- if 'note' in otel %}
<br><br>**Note:** {{ otel['note'] }}
{%- endif %}
{%- endfor %}
{%- endif %}
 | {{ field['level'] }} |
{%- endset %}
{{ row | replace("\n", "") }}
{% endif %}
{% endfor %}

{# field reuse section -#}
{% if 'reusable' in fieldset -%}

## Field reuse [_field_reuse]

The `{{ fieldset['name'] }}` fields are expected to be nested at:

{% for entry in sorted_reuse_fields %}
* `{{ entry }}`
{% endfor %}

{% if 'top_level' in fieldset['reusable'] and fieldset['reusable']['top_level'] -%}

Note also that the `{{ fieldset['name'] }}` fields may be used directly at the root of the events.

{% else -%}

Note also that the `{{ fieldset['name'] }}` fields are not expected to be used directly at the root of the events.

{%- endif %}
{% endif %}

{% if 'nestings' in fieldset -%}

### Field sets that can be nested under {{ fieldset['title'] }} [ecs-{{ fieldset['name'] | lower }}-nestings]

| Location | Field Set | Description |
| --- | --- | --- |
{% for entry in render_nestings_reuse_section -%}
{% set row %}
| `{{ entry['flat_nesting'] }}` | [{{ entry['name'] }}](/reference/ecs-{{ entry['name'] }}.md) |
{% if entry['beta'] -%}
{{ entry['foo'] }} _{{ entry['beta'] }}_ {{ entry['short'] }}
{%- else %}
{{ entry['foo'] }} {{ entry['short'] }}
{%- endif %}
{% if entry['normalize'] and 'array' in entry['normalize'] -%}
**Note:** This reuse should contain an array of {{ entry['name'] }} field set objects.
{% endif -%}
{% endset %}
{{ row | replace("\n", "") }} |
{% endfor -%}

{% endif %}

{%- if usage_doc %}

### {{ fieldset['title'] }} field usage [_{{ fieldset['name'] }}_field_usage]

For usage and examples of the {{ fieldset['name'] }} fields, please see the [{{ fieldset['title'] }} fields usage and examples](/reference/ecs-{{ fieldset['name']|replace("_", "-") }}-usage.md) section.

{% endif %}
