---
- name: pe
  title: PE Header
  group: 2
  description: These fields contain Windows Portable Executable (PE) metadata.
  type: group
  reusable:
    top_level: false
    expected:
      - file
      - dll
      - process
  fields:
    - name: original_file_name
      level: extended
      type: keyword
      description: Internal name of the file, provided at compile-time.
      example: MSPAINT.EXE

    - name: file_version
      level: extended
      type: keyword
      short: Process name.
      description: Internal version of the file, provided at compile-time.
      example: 6.3.9600.17415

    - name: description
      level: extended
      type: keyword
      description: Internal description of the file, provided at compile-time.
      example: Paint

    - name: product
      level: extended
      type: keyword
      description: Internal product name of the file, provided at compile-time.
      example: Microsoft® Windows® Operating System

    - name: company
      level: extended
      type: keyword
      description: Internal company name of the file, provided at compile-time.
      example: Microsoft Corporation

    - name: imphash
      level: extended
      type: keyword
      short: A hash of the imports in a PE file.
      description: >
        A hash of the imports in a PE file. An imphash -- or import hash -- can
        be used to fingerprint binaries even after recompilation or other code-level
        transformations have occurred, which would change more traditional hash values.

        Learn more at https://www.fireeye.com/blog/threat-research/2014/01/tracking-malware-import-hashing.html.
      example: 0c6803c4e922103c4dca5963aad36ddf

    - name: architecture
      level: extended
      type: keyword
      description: CPU architecture target for the file.
      example: x64

    - name: flattened
      release: beta
      type: group
      fields:
        - name: debug
          default_field: false
          description: >
            Debug information, if present
          type: flattened
        - name: import_list
          default_field: false
          description: >
            List of all imported functions
          type: flattened
        - name: sections
          default_field: false
          description: >
            Data about sections of compiled binary PE
          type: flattened
        - name: resource_details
          default_field: false
          type: flattened
          description: >
            If the PE contains resources, some info about them
        - name: resource_languages
          default_field: false
          type: flattened
          description: >
            Digest of languages found in resources. Key is language (as string) and
            value is how many resources there are having that language (as integer)
        - name: resource_types
          default_field: false
          type: flattened
          description: >
            Digest of resource types. Key is resource type (as string) and value
            is how many resources there are of that specific type (as integer)
        - name: packers
          default_field: false
          type: flattened
          description: >
            Identifies packers used on Windows PE files by several tools and AVs.
            Keys are tool names and values are identified packers, both strings.
            see `file.pe.packers` for merged list of packers from all tools.
      
    - name: exports
      type: keyword
      description: >
        List of symbols exported by PE

    - name: creation_date
      default_field: false
      description: >
        extracted when possible from the file's metadata. Indicates when it was
        built or compiled. It can also be faked by malware creators.
      type: date
    - name: authentihash
      description: >
        Authentihash of the PE file.
      type: keyword
    - name: compile_timestamp
      description: >
        Compile timestamp of the PE file.
      type: date

    - name: packers
      type: keyword
      description: >
        Merged list of all detected packers by all tools used. See `file.pe.flattened.packers`.

    - name: main_icon.hash
      type: group
      description: >
        Hashes of embedded program icon
      fields:
        - name: dhash
          description: >
            Difference Hash for a given PE file.
          type: keyword
          release: beta
        - name: md5
          type: keyword
          description: >
            MD5 hash of raw icon data
          release: beta
    - name: compiler_product_versions
      type: keyword
      description: >
        Version of the compiler.
    - name: rich_pe_header_hash
      type: keyword
      description: >
        Hash of the PE header.
    - name: entry_point
      description: >
        Entry point of the PE file.
      format: string
      type: long
    - name: machine_type
      description: >
        Machine type of the PE file.
      type: keyword
    - name: overlay
      description: >
        Overlay information of the PE file.
      release: beta
      type: group
      fields:
        - name: chi2
          description: >
            Chi2 information of the PE file.
          type: float
        - name: entropy
          description: >
            Entropy information of the PE file.
          type: float
        - name: filetype
          description: >
            Filetype of the PE file.
          type: keyword
        - name: md5
          description: >
            Overlay MD5 hash of the PE file.
          type: keyword
        - name: offset
          description: >
            Offset of the overlay information of the PE file.
          type: long
        - name: size
          description: >
            Size of the PE file.
          format: bytes
          type: long
        - name: rich_pe_header_hash
          description: >
            Hash of the header for the PE file.
          type: keyword
