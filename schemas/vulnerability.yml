---
- name: vulnerability
  title: Vulnerability
  group: 2
  short: Fields to describe the vulnerabilty relevant to an event.
  description: >
    The vulnerability fields describe information about a vulnerabilty that is relevant to an event.

    Fields can have one entry or multiple entries.

  type: group
  fields:

    - name: cvss.score.base
      level: extended
      type: long
      short: CVSS Base score.
      description: >
        The Common Vulnerability Scoring System (CVSS) is an open framework for communicating the characteristics and severity of software vulnerabilities. Scores can range from 0.0 to 10.0, with 10.0 being the most severe.

        Base scores cover an assessment for exploitability metrics (attack vector, complexity, privileges, and user interaction), impact metrics (confidentialy, integrity, and availability), and scope. For example (ex. https://www.first.org/cvss/specification-document)

      example: 5.5, 6.6

    - name: cvss.score.temporal
      level: extended
      type: long
      short: CVSS Temporal score.
      description: >
        The Common Vulnerability Scoring System (CVSS) is an open framework for communicating the characteristics and severity of software vulnerabilities. Scores can range from 0.0 to 10.0, with 10.0 being the most severe.

        Temporal scores cover an assessment for code maturity, remediation level, and confidence. For example (ex. https://www.first.org/cvss/specification-document)

    - name: cvss.score.version
      level: extended
      type: long
      short: CVSS version.
      description: >
        The National Vulnerability Database (NVD) provides qualitative severity rankings of "Low", "Medium", and "High" for CVSS v2.0 base score ranges in addition to the severity ratings for CVSS v3.0 as they are defined in the CVSS v3.0 specification.

        CVSS is owned and managed by FIRST.Org, Inc. (FIRST), a US-based non-profit organization, whose mission is to help computer security incident response teams across the world. For example (ex. https://nvd.nist.gov/vuln-metrics/cvss)

      example: 2.0, 3.0

    - name: cvss.score.evironmental
      level: extended
      type: long
      short: CVSS Environmental score.
      description: >
        The Common Vulnerability Scoring System (CVSS) is an open framework for communicating the characteristics and severity of software vulnerabilities. Scores can range from 0.0 to 10.0, with 10.0 being the most severe.

        Environmental scores cover an assessment for any modified Base metrics, confidentiality, integrity, and availability requirements. For example (ex. https://www.first.org/cvss/specification-document)

      example: 5.5, 6.6

    - name: category
      level: extended
      type: keyword
      short: Category of a vulnerabilty.
      description: >
        The type of system or architecture that the vulnerability affects. These may be platform-specific (for example, Debian or SUSE) or general (for example, Database or Firewall). For example (ex. https://qualysguard.qualys.com/qwebhelp/fo_portal/knowledgebase/vulnerability_categories.htm)

      example: AIX, Firewall, Malware, Office Application, Solaris, Windows

    - name: cve.description
      level: extended
      type: keyword
      short: Description of the vulnerability.
      description: >
        The Common Vulnerability and Exposures (CVE) list is an open source list for publicly known cybersecurity vulnerabilities providing an identification number, a description, and at least one public reference.

        The description of the vulnerability that provides additional context of the vulnerability. For example (ex. https://cve.mitre.org/about/faqs.html#cve_entry_descriptions_created)

      example: In Keybase before 2.12.6 on macOS, the move RPC to the Helper was susceptible to time-to-check-time-to-use bugs and would also allow one user of the system (who didn't have root access) to tamper with another's installs.

    - name: cve.id
      level: extended
      type: keyword
      short: ID of the vulnerability.
      description: >
        The Common Vulnerability and Exposures (CVE) list is an open source list for publicly known cybersecurity vulnerabilities providing an identification number, a description, and at least one public reference.

        The identification (ID) is the number portion of a CVE Entry. It includes the year the vulnerability ID was requested followed by a sequence number. CVE-YYYY-NNNNN. For example (ex. https://cve.mitre.org/about/faqs.html#what_is_cve_id)

      example: CVE-2019-00001, CVE-2019-00002

    - name: severity
      level: extended
      type: keyword
      short: Severity of the vulnerability.
      description: >
        The severity of the vulnerability can help with metrics and internal prioritization regarding remediation. For example (ex. https://nvd.nist.gov/vuln-metrics/cvss)

      example: Critical, High, Medium, Low, None

    - name: status
      level: extended
      type: keyword
      short: Status of the vulnerability.
      description: >
        The current status of the vulerability on the asset:

        New - The first time a vulnerability is detected by a scan the status is set to New.
        Active - A vulnerability detected by two or more scans is set to Active.
        Fixed - A vulnerability was verified by the most recent scan as fixed, and this vulnerability was detected by the previous scan.
        Re-Opened - A vulnerability was reopened by the most recent scan, and this vulnerability was verified as fixed by the previous scan.

        For example (ex. https://qualysguard.qualys.com/qwebhelp/fo_portal/scans/vulnerability_status.htm)

      example: New, Active, Fixed, Re-Opened

    - name: detected.first
      level: extended
      type: date
      short: Vulnerability first observed.
      description: >
        The first time that the vulnerability was observed on the asset.

      example: YYYY-MM-DD-HH-MM

    - name: detected.last
      level: extended
      type: date
      short: Vulnerability last observed.
      description: >
        The last time that the vulnerability was observed on the asset.

      example: YYYY-MM-DD-HH-MM

    - name: scanned.first
      level: extended
      type: date
      short: Asset first scanned.
      description: >
        The first time that the asset was scanned for vulnerabilities.

      example: YYYY-MM-DD-HH-MM

    - name: scanned.last
      level: extended
      type: date
      short: Asset last scanned.
      description: >
        The last time that the asset was scanned for vulnerabilities.

      example: YYYY-MM-DD-HH-MM

    - name: id
      level: extended
      type: keyword
      short: Scan identification number.
      description: >
        The report or scan identification number.

      example: 20191018.0001, SCAN0001
