---
- name: pe
  type: group
  fields:
    - name: icon
      level: extended
      type: object
      description: >
        Information of embedded program icon.
      fields:
        - name: hash
          level: extended
          description: >
            Hash of the header for the PE file
          type: object
          fields:
            - name: md5
              level: extended
              type: keyword
              description: >
                MD5 hash of raw icon data.
              example: 5aa1aa0f2b4be70397a1e9e2b87627cd

            - name: sha1
              level: extended
              type: keyword
              description: >
                SHA1 hash of raw icon data.
              example: e8ff6bf77c652168f958ab4194af48b75ef1e4dd

            - name: sha256
              level: extended
              type: keyword
              description: >
                SHA256 hash of raw icon data.
              example: d81d0dbc5e691ea1082db0a8f82f978f3768d46d23049935dff2d935f932d1a2

            - name: dhash
              level: extended
              type: keyword
              description: >
                Difference Hash (dhash) to find files with a visually similar icon or thumbnail.
              example: b806e17c8e330d82

    - name: debug
      level: extended
      type: keyword
      description: Debug information, if present
      example: { "offset" : 1296336, "size" : 816, "type_str" : "IMAGE_DEBUG_TYPE_POGO", "type" : 13, "timestamp" : "Wed Oct 21 09:01:33 2020" }

    - name: import_list
      level: extended
      type: keyword
      description: List of all imported functions
      example: { "library_name" : "mscoree.dll", "imported_functions" : "GetFileVersionInfoSizeA" }

    - name: sections
      level: extended
      description: >
        Data about sections of compiled binary PE
      type: keyword
      example: { "chi2" : 3027194, "virtual_address": 8192, "entropy": 6.24, "flags": "rx", "name": ".text", "raw_size": 198144 }

    - name: resource_details
      level: extended
      type: keyword
      description: >
        If the PE contains resources, some info about them
      example: { "chi2": -1, "filetype": "English text", "entropy": 0, "sha256": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855", "lang": "CHINESE SIMPLIFIED" }

    - name: resource_types
      level: extended
      type: keyword
      short: List of resource types.
      description: >
        Digest of resource types. Key is resource type (as string) and value
        is how many resources there are of that specific type (as integer)
      example: { "RT_VERSION": 1, "RT_MANIFEST": 1 }

    - name: exports
      level: extended
      type: keyword
      description: >
        List of symbols exported by PE
      example: DllInstall, DllRegisterServer, DllUnregisterServer

    - name: creation_date
      level: extended
      short: Build or compile date.
      description: >
        Extracted when possible from the file's metadata. Indicates when it was
        built or compiled. It can also be faked by malware creators.
      type: date
      example: "2020-11-05T17:25:47.000Z"

    - name: authentihash
      level: extended
      description: >
        Authentihash of the PE file.
      type: keyword
      example: ac9555d914bbb112ecc5f15bb9887ca8371f493ab0941344e976bb8410c8aa78

    - name: compile_timestamp
      level: extended
      description: >
        Compile timestamp of the PE file.
      type: date
      example: "2020-11-05T17:25:47.000Z"

    - name: compiler
      level: extended
      description: >
        Compiler information for the PE file.
      type: object
      fields:
        - name: name
          level: extended
          type: keyword
          description: >
            Name of the compiler
          example: Clang

        - name: version
          level: extended
          type: keyword
          description: >
            Version of the compiler.
          example: 11.0.0

    - name: rich_header
      level: extended
      description: >
        Rich Header information for the PE file.
      type: object
      fields:
        - name: hash
          level: extended
          description: >
            Hash of the header for the PE file
          type: object
          fields:
            - name: md5
              level: extended
              type: keyword
              description: >
                MD5 hash of the header for the PE file.
              example: 5aa1aa0f2b4be70397a1e9e2b87627cd

    - name: entry_point
      level: extended
      description: >
        Entry point of the PE file.
      type: keyword
      example: 25856

    - name: machine_type
      level: extended
      description: >
        Machine type of the PE file.
      type: keyword
      example: "Intel 386 or later, and compatibles", "AMD AMD64", 332, 34404
