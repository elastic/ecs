---
- name: macho
  title: Mach-O file information.
  group: 2
  description: >
    These fields contain macOS Mach Object (Mach-O) metadata.
  type: nested
  reusable:
    top_level: false
    expected:
      - file
      - process
  fields:
    - name: cdhash
      description: Code Digest (CD) SHA256 hash of the first 20-bytes of the file.
      type: keyword
      level: extended
      example: 2035094a7065b29421e7a51f51db9bd61807c3628f210b1f8e667235777dc592

    - name: cpu.architecture
      description: CPU architecture target for the file.
      type: keyword
      level: extended
      example: 64-bit

    - name: cpu.byte_order
      description: CPU byte order for the file.
      type: keyword
      level: extended
      example: Little endian

    - name: cpu.subtype
      description: CPU subtype for the file.
      type: keyword
      level: extended
      example: ARM (all) 64-bit

    - name: cpu.type
      description: CPU type for the file.
      type: keyword
      level: extended
      example: ARM 64-bit

    - name: headers.commands.number
      description: Number of load commands for the Mach-O header.
      type: long
      level: extended
      example: 23

    - name: headers.commands.size
      description: Size of load commands of the Mach-O header.
      type: long
      level: extended
      format: bytes
      example: 3888

    - name: headers.commands.type
      description: Type of the load commands for the Mach-O header.
      type: keyword
      level: extended
      example: LC_SYMTAB, 0x2c

    - name: headers.magic
      description: Magic field of the Mach-O header.
      type: keyword
      level: extended
      example: 0xfeedfacf

    - name: headers.flags
      description: Flags set in the Mach-O header.
      type: keyword
      level: extended
      example: TWOLEVEL

    - name: page_size
      description: Page size of the file.
      type: long
      format: bytes
      level: extended
      example: 4096

    - name: sections.chi2
      description: Chi-squared probability distribution of the section.
      type: float
      level: extended
      example: 3.413

    - name: sections.entropy
      description: Shannon entropy calculation from the section.
      type: float
      level: extended
      example: 1.5

    - name: sections.flags
      description: Section flags for the segment of the file.
      type: keyword
      level: extended
      example: SECTION_ATTRIBUTES_SYS

    - name: sections.name
      description: Section name for the segment of the file.
      type: keyword
      level: extended
      example: __text

    - name: sections.type
      description: Section type for the segment of the file.
      type: keyword
      level: extended
      example: S_REGULAR

    - name: sections.physical_offset
      description: Section List offset.
      type: keyword
      level: extended
      example: 0x0

    - name: sections.physical_size
      description: Section List physical size.
      type: long
      level: extended
      example: 311296

    - name: sections.virtual_address
      description: Section List virtual address.
      type: keyword
      level: extended
      example: 0x0

    - name: sections.virtual_size
      description: Section List virtual size.
      type: long
      level: extended
      example:  311296

    - name: segments.name
      description: Name of this segment.
      type: keyword
      level: extended
      example: __TEXT, __DATA, __IMPORT

    - name: segments.physical_offset
      description: File offset of this segment.
      type: keyword
      level: extended
      example: 0x0

    - name: segments.physical_size
      description: Amount of memory to map from the file.
      type: long
      level: extended
      example: 311296

    - name: segments.sections
      level: extended
      description: Section names contained in this segment.
      type: keyword

    - name: segments.virtual_address
      description: Memory address of this segment.
      type: keyword
      level: extended
      example: 0x0

    - name: segments.virtual_size
      description: Memory size of this segment.
      type: long
      level: extended
      example: 311296
